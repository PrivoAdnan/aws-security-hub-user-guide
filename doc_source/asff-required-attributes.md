# Required attributes<a name="asff-required-attributes"></a>

The following attributes are required for all findings in Security Hub\. For more information about these required attributes, see [AwsSecurityFinding](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html) in the *AWS Security Hub API Reference*\.

`AwsAccountId`  
The AWS account ID that the finding applies to\.  
**Example**  

```
"AwsAccountId": "111111111111"
```

`CreatedAt`  
Indicates when the potential security issue captured by a finding was created\.  
**Example**  

```
"CreatedAt": "2017-03-22T13:22:13.933Z"
```
Findings are deleted 90 days after the most recent update or 90 days after the creation date if no update occurs\. To store findings for longer than 90 days, you can configure a rule in Amazon EventBridge that routes findings to your S3 bucket\.

`Description`  
A finding's description\. This field can be nonspecific boilerplate text or details that are specific to the instance of the finding\.  
**Example**  

```
"Description": "The version of openssl found on instance i-abcd1234 is known to contain a vulnerability."
```

`GeneratorId`  
The identifier for the solution\-specific component \(a discrete unit of logic\) that generated a finding\. In various solutions from security findings products, this generator can be called a rule, a check, a detector, a plugin, and so on\.  
**Example**  

```
"GeneratorId": "acme-vuln-9ab348"
```

`Id`  
The product\-specific identifier for a finding\.  
**Example**  

```
"Id": "us-west-2/111111111111/98aebb2207407c87f51e89943f12b1ef"
```

`ProductArn`  
The ARN generated by Security Hub that uniquely identifies a third\-party findings product after the product is registered with Security Hub\.  
The format of this field is `arn:partition:securityhub:region:account-id:product/company-id/product-id`\.  
+ For AWS services that are integrated with Security Hub, the `company-id` must be "`aws`", and the `product-id` must be the AWS public service name\. Because AWS products and services aren't associated with an account, the `account-id` section of the ARN is empty\. AWS services that are not yet integrated with Security Hub are considered third\-party products\.
+ For public products, the `company-id` and `product-id` must be the ID values specified at the time of registration\.
+ For private products, the `company-id` must be the account ID\. The `product-id` must be the reserved word "default" or the ID that was specified at the time of registration\.
Example:  

```
// Private ARN
    "ProductArn": "arn:aws:securityhub:us-east-1:111111111111:product/111111111111/default"

// Public ARN
    "ProductArn": "arn:aws:securityhub:us-west-2::product/aws/guardduty"
    "ProductArn": "arn:aws:securityhub:us-west-2:222222222222:product/generico/secure-pro"
```

[`Resources`](asff-resources.md)  
A set of resource data types that describe the resources that the finding refers to\.  
**Example**  

```
"Resources": [
  {
    "Type": "AwsEc2Instance",
    "Id": "i-cafebabe",
    "Partition": "aws",
    "Region": "us-west-2",
    "Tags": {
      "billingCode": "Lotus-1-2-3",
      "needsPatching": "true"
    },
    "Details": {
      "IamInstanceProfileArn": "arn:aws:iam::123456789012:role/IamInstanceProfileArn",
      "ImageId": "ami-79fd7eee",
      "IpV4Addresses": ["1.1.1.1"],
      "IpV6Addresses": ["2001:db8:1234:1a2b::123"],
      "KeyName": "testkey",
      "LaunchedAt": "2018-09-29T01:25:54Z",
      "MetadataOptions": {
        "HttpEndpoint": "enabled",
        "HttpProtocolIpv6": "enabled",
        "HttpPutResponseHopLimit": 1,
        "HttpTokens": "optional",
        "InstanceMetadataTags": "disabled"
      },
      "NetworkInterfaces": [
      {
        "NetworkInterfaceId": "eni-e5aa89a3"
      }
      ],
      "SubnetId": "PublicSubnet",
      "Type": "i3.xlarge",
      "VirtualizationType": "hvm",
      "VpcId": "TestVPCIpv6"
    }
  }
]
```

`SchemaVersion`  
The schema version that a finding is formatted for\. The value of this field must be one of the officially published versions identified by AWS\.  
In the current release, the AWS Security Finding Format schema version is `2018-10-08`\.   
**Example**  

```
"SchemaVersion": "2018-10-08"
```

[`Severity`](asff-severity.md)  
A finding's severity\.  
The finding must have either `Label` or `Normalized` populated\. `Label` is the preferred attribute\. `Normalized` is no longer relevant\. Security Hub populates the `Normalized` attribute but does not otherwise use it\. If neither attribute is populated, then the finding is invalid\.  
`Severity` should only be updated by [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html)\.  
To provide severity information, finding providers should use the `Severity` object under [`FindingProviderFields`](asff-findingproviderfields.md)\. See [Using FindingProviderFields](finding-update-batchimportfindings.md#batchimportfindings-findingproviderfields)\.  
**Example**  

```
"Severity": {
    "Label": "CRITICAL",
    "Original": "8.3"
}
```

`Title`  
A finding's title\. This field can contain nonspecific boilerplate text or details that are specific to this instance of the finding\.

`Types`  
One or more finding types in the format of `namespace/category/classifier` that classify a finding\.  
`Types` should only be updated using [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html)\.  
Finding providers who want to provide a value for `Types` should use the `Types` attribute under [`FindingProviderFields`](asff-findingproviderfields.md)\. See [Using FindingProviderFields](finding-update-batchimportfindings.md#batchimportfindings-findingproviderfields)\.  
+ `namespace` must be a value from the predefined set of namespace values\.

  Valid values: `Software and Configuration Checks` \| `TTPs` \| `Effects` \| `Unusual Behaviors` \| `Sensitive Data Identifications`
+ `category` might be any value, but it is recommended that finding products use categories from the finding type taxonomy in [Types taxonomy for ASFF](securityhub-findings-format-type-taxonomy.md)\.
+ `classifier` might be any value, but it is recommended that finding providers use the identifier exactly as defined by published standards whenever possible\.
Namespaces are required for all finding types, but categories and classifiers are optional\. If you specify a classifier, you must also specify a category\.  
The '`/`' character is reserved and must not be used in a category or classifier\. Escaping the '`/`' character is not supported\.  
**Example**  

```
"Types": [
    "Software and Configuration Checks/Vulnerabilities/CVE"
]
```

`UpdatedAt`  
Indicates when the finding provider last updated the finding record\.  
This timestamp reflects the time when the finding record was last or most recently updated\. Consequently, it can differ from the `LastObservedAt` timestamp, which reflects when the event or vulnerability was last or most recently observed\.  
When you update the finding record, you must update this timestamp to the current timestamp\. Upon creation of a finding record, the `CreatedAt` and `UpdatedAt` timestamps must be the same\. After an update to the finding record, the value of this field must be greater than all of the previous values that it contained\.  
Note that `UpdatedAt` is not updated by changes from [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html)\. It is only updated by [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html)\.  
Findings are deleted 90 days after the most recent update or 90 days after the creation date if no update occurs\. To store findings for longer than 90 days, you can configure a rule in CloudWatch Events that routes findings to your Amazon S3 bucket\.