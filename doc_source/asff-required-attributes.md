# Required attributes<a name="asff-required-attributes"></a>

The following attributes are required for all findings\.

`AwsAccountId`  
Required  
The AWS account ID that the finding applies to\.  
**Type:** String  
**Maximum length:** 12 digits  
**Example**  

```
"AwsAccountId": "111111111111"
```

`CreatedAt`  
Required  
Indicates when the potential security issue captured by a finding was created\.  
The `CreatedAt` timestamp reflects the time when the finding record was created\. Consequently, it can differ from the `FirstObservedAt` timestamp, which reflects the time when the event or vulnerability was first observed\.  
This timestamp must be provided on the first generation of the finding and cannot be changed upon subsequent updates to the finding\.  
**Type:** String  
**Format:** Uses the `date-time` format specified in [RFC 3339 section 5\.6, Internet Date/Time Format](https://tools.ietf.org/html/rfc3339#section-5.6)\. The value cannot contain spaces\.  
**Example**  

```
"CreatedAt": "2017-03-22T13:22:13.933Z"
```
Findings are deleted 90 days after the most recent update or 90 days after the creation date if no update occurs\. To store findings for longer than 90 days, you can configure a rule in Amazon EventBridge that routes findings to your S3 bucket\.

`Description`  
Required  
A finding's description\. This field can be nonspecific boilerplate text or details that are specific to the instance of the finding\.  
**Type:** String  
**Maximum length:** 1,024  
**Example**  

```
"Description": "The version of openssl found on instance i-abcd1234 is known to contain a vulnerability."
```

`GeneratorId`  
Required  
The identifier for the solution\-specific component \(a discrete unit of logic\) that generated a finding\. In various solutions from security findings products, this generator can be called a rule, a check, a detector, a plugin, and so on\.  
**Type:** String or ARN  
**Maximum length:** 512  
**Example**  

```
"GeneratorId": "acme-vuln-9ab348"
```

`Id`  
Required  
The product\-specific identifier for a finding\.  
**Type:** String or ARN  
**Maximum length:** 512 for string values, 2048 for ARN values  
The finding ID must comply with the following constraints:  
+ The ID must be globally unique within the product\. To enforce uniqueness, you can incorporate the public AWS Region name and account ID in the identifier\.
+ You *cannot* recycle identifiers regardless of whether the previous finding no longer exists\.
+ For services outside of AWS, the ID *cannot* be prefixed with the literal string "`arn:`"\.
+ For AWS services, the ID *must* be the ARN of the finding if one is available\. Otherwise, you can use any other unique identifier\.
These constraints are expected to hold within a finding product but are not required to hold across finding products\.  
**Example**  

```
"Id": "us-west-2/111111111111/98aebb2207407c87f51e89943f12b1ef"
```

`ProductArn`  
Required  
The ARN generated by Security Hub that uniquely identifies a third\-party findings product after the product is registered with Security Hub\.  
**Type:** ARN  
The format of this field is `arn:partition:securityhub:region:account-id:product/company-id/product-id`\.  
+ For AWS services that are integrated with Security Hub, the `company-id` must be "`aws`", and the `product-id` must be the AWS public service name\. Because AWS products and services aren't associated with an account, the `account-id` section of the ARN is empty\. AWS services that are not yet integrated with Security Hub are considered third\-party products\.
+ For public products, the `company-id` and `product-id` must be the ID values specified at the time of registration\.
+ For private products, the `company-id` must be the account ID\. The `product-id` must be the reserved word "default" or the ID that was specified at the time of registration\.
Example:  

```
// Private ARN
    "ProductArn": "arn:aws:securityhub:us-east-1:111111111111:product/111111111111/default"

// Public ARN
    "ProductArn": "arn:aws:securityhub:us-west-2::product/aws/guardduty"
    "ProductArn": "arn:aws:securityhub:us-west-2:222222222222:product/generico/secure-pro"
```

[`Resources`](asff-resources.md)  
Required  
A set of resource data types that describe the resources that the finding refers to\.  
**Type:** Array of resource objects  
**Maximum number of objects:** 32  
**Example**  

```
"Resources": [
  {
    "Type": "AwsEc2Instance",
    "Id": "i-cafebabe",
    "Partition": "aws",
    "Region": "us-west-2",
    "Tags": {
      "billingCode": "Lotus-1-2-3",
      "needsPatching": "true"
    },
    "Details": {
      "AwsEc2Instance": {
        "Type": "i3.xlarge",
        "ImageId": "ami-abcd1234",
        "IpV4Addresses": [ "54.194.252.215", "192.168.1.88" ],
        "IpV6Addresses": [ "2001:db8:1234:1a2b::123" ],
        "KeyName": "my_keypair",
        "IamInstanceProfileArn": "arn:aws:iam::111111111111:instance-profile/AdminRole",
        "VpcId": "vpc-11112222",
        "SubnetId": "subnet-56f5f633",
        "LaunchedAt": "2018-05-08T16:46:19.000Z"
      }  
    }
  }
]
```

`SchemaVersion`  
Required  
The schema version that a finding is formatted for\. The value of this field must be one of the officially published versions identified by AWS\.  
In the current release, the AWS Security Finding Format schema version is `2018-10-08`\.   
**Type:** String  
**Maximum length:** 10  
**Format:** `YYYY-MM-DD`  
**Example**  

```
"SchemaVersion": "2018-10-08"
```

[`Severity`](asff-severity.md)  
Required  
A finding's severity\.  
The finding must have either `Label` or `Normalized` populated\. `Label` is the preferred attribute\. `Normalized` is no longer relevant\. Security Hub populates the `Normalized` attribute but does not otherwise use it\. If neither attribute is populated, then the finding is invalid\.  
`Severity` should only be updated by [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html)\.  
To provide severity information, finding providers should use the `Severity` object under [`FindingProviderFields`](asff-findingproviderfields.md)\. See [Using FindingProviderFields](finding-update-batchimportfindings.md#batchimportfindings-findingproviderfields)\.  
**Type:** Object  
**Example**  

```
"Severity": {
    "Label": "CRITICAL",
    "Original": "8.3"
}
```

`Title`  
Required  
A finding's title\. This field can contain nonspecific boilerplate text or details that are specific to this instance of the finding\.  
**Type:** String  
**Maximum length:** 256

`Types`  
Required  
One or more finding types in the format of `namespace/category/classifier` that classify a finding\.  
`Types` should only be updated using [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html)\.  
Finding providers who want to provide a value for `Types` should use the `Types` attribute under [`FindingProviderFields`](asff-findingproviderfields.md)\. See [Using FindingProviderFields](finding-update-batchimportfindings.md#batchimportfindings-findingproviderfields)\.  
**Type:** Array of strings  
**Maximum number of strings:** 50  
+ `namespace` must be a value from the predefined set of namespace values\.

  Valid values: `Software and Configuration Checks` \| `TTPs` \| `Effects` \| `Unusual Behaviors` \| `Sensitive Data Identifications`
+ `category` might be any value, but it is recommended that finding products use categories from the finding type taxonomy in [Types taxonomy for ASFF](securityhub-findings-format-type-taxonomy.md)\.
+ `classifier` might be any value, but it is recommended that finding providers use the identifier exactly as defined by published standards whenever possible\.
Namespaces are required for all finding types, but categories and classifiers are optional\. If you specify a classifier, you must also specify a category\.  
The '`/`' character is reserved and must not be used in a category or classifier\. Escaping the '`/`' character is not supported\.  
**Example**  

```
"Types": [
    "Software and Configuration Checks/Vulnerabilities/CVE"
]
```

`UpdatedAt`  
Required  
Indicates when the finding provider last updated the finding record\.  
This timestamp reflects the time when the finding record was last or most recently updated\. Consequently, it can differ from the `LastObservedAt` timestamp, which reflects when the event or vulnerability was last or most recently observed\.  
When you update the finding record, you must update this timestamp to the current timestamp\. Upon creation of a finding record, the `CreatedAt` and `UpdatedAt` timestamps must be the same\. After an update to the finding record, the value of this field must be greater than all of the previous values that it contained\.  
Note that `UpdatedAt` is not updated by changes from [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchUpdateFindings.html)\. It is only updated by [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html)\.  
Findings are deleted 90 days after the most recent update or 90 days after the creation date if no update occurs\. To store findings for longer than 90 days, you can configure a rule in CloudWatch Events that routes findings to your Amazon S3 bucket\.  
**Type:** String  
**Format:** Uses the `date-time` format specified in [RFC 3339 section 5\.6, Internet Date/Time Format](https://tools.ietf.org/html/rfc3339#section-5.6)\. The value cannot contain spaces\.